<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Locator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        #map {
            width: 100%;
            height: 400px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <header>
        <section class="g6logo">
            <div class="g6logo">
                <a href="{{ url_for('home') }}">
                    <img src="/static/images/g6logo.png" alt="g6logo">
                </a>
            </div>
        </section>
        <nav>
            <a href="{{ url_for('menu') }}">Menu</a>
            <a href="{{ url_for('cart') }}">
                <img src="{{ url_for('static', filename='images/cart.png') }}" height="50px" weight="50">
            </a>
        </nav>
    </header>

    <main>
        <h2>SELECT YOUR LOCAL STORE</h2>
        <form id="storeLocatorForm">
            <input type="text" id="locationInput" placeholder="Enter your location" required>
            <button type="submit">Search</button>
        </form>

        <div id="store-results">
            <!-- Store results will appear here -->
        </div>

        <div id="map"></div>

        <div class="delivery-form">
            <h2>Delivery Details</h2>
            <form id="deliveryDetailsForm">
                <input type="text" id="houseNumber" placeholder="House Number" required>
                <input type="text" id="streetName" placeholder="Street Name" required>
                <input type="text" id="subdivisionName" placeholder="Subdivision Name">
                <input type="text" id="barangay" placeholder="Barangay" required>
                <input type="text" id="city" placeholder="City" required>
                <textarea id="deliveryInstruction" placeholder="Delivery Instructions" rows="3" style="width: 100%; margin-top: 10px; padding: 10px;"></textarea>
                <a href="{{ url_for('menu') }}">
                    <button type="button" onclick="submitDeliveryDetails()">Submit Details</button></a>
            </form>
            <p id="deliveryCharge" style="margin-top: 10px;"></p>
        </div>
    </main>

    <script>
    let map, geocoder, userMarker;

// Initialize Google Map
function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: -34.397, lng: 150.644 }, // Default center
        zoom: 8
    });
    geocoder = new google.maps.Geocoder();
}

// Event listener for store locator form
document.getElementById('storeLocatorForm').addEventListener('submit', function(event) {
    event.preventDefault();
    const location = document.getElementById('locationInput').value;
    const resultsDiv = document.getElementById('store-results');

    // Geocode the location entered by the user
    geocoder.geocode({ 'address': location }, function(results, status) {
        if (status === 'OK') {
            const locationLatLng = results[0].geometry.location;
            map.setCenter(locationLatLng);
            map.setZoom(12);

            // Remove old user marker if exists
            if (userMarker) {
                userMarker.setMap(null);
            }

            // Display marker for entered location
            userMarker = new google.maps.Marker({
                map: map,
                position: locationLatLng,
                title: 'Your Location'
            });

            // Simulate fetching store data
            const mockStores = [
                { name: 'Store A', address: '123 Main St, Cityville', distance: '2 miles', lat: -34.397, lng: 150.644 },
                { name: 'Store B', address: '456 Elm St, Townsville', distance: '5 miles', lat: -34.400, lng: 150.650 }
            ];

            // Display mock store results
            resultsDiv.innerHTML = '';
            mockStores.forEach(store => {
                const storeDiv = document.createElement('div');
                storeDiv.innerHTML = `<strong>${store.name}</strong><br>${store.address}<br><em>${store.distance}</em>`;
                storeDiv.style.marginBottom = '10px';
                resultsDiv.appendChild(storeDiv);

                // Add marker for each store
                new google.maps.Marker({
                    map: map,
                    position: { lat: store.lat, lng: store.lng },
                    title: store.name
                });
            });
        } else {
            resultsDiv.innerHTML = `<p>Error: ${status}</p>`;
        }
    });
});

// Submit delivery details
function submitDeliveryDetails() {
    // Get the values from the input fields
    const houseNumber = document.getElementById("houseNumber").value;
    const streetName = document.getElementById("streetName").value;
    const subdivisionName = document.getElementById("subdivisionName").value;
    const barangay = document.getElementById("barangay").value;
    const city = document.getElementById("city").value;
    const deliveryInstruction = document.getElementById("deliveryInstruction").value;

    // Create an object with the delivery details
    const deliveryDetails = {
        houseNumber,
        streetName,
        subdivisionName,
        barangay,
        city,
        deliveryInstruction
    };

    // Save the delivery details to localStorage
    localStorage.setItem('deliveryDetails', JSON.stringify(deliveryDetails));

    // Optionally, show a message or update the UI to reflect the saved details
    alert("Delivery details saved successfully!");
}

// Add event listener to the button to trigger the submitDeliveryDetails function
document.getElementById('submitDetailsButton').addEventListener('click', function(event) {
    event.preventDefault(); // Prevent form submission
    submitDeliveryDetails(); // Call the function to save delivery details
});



</script>

<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>

</body>
</html>

<style>

.delivery-form {
    max-width: 700px;
    margin: 0 auto;
    padding: 20px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    font-family: Arial, sans-serif;
}

.delivery-form h2 {
    text-align: center;
    color: #333;
    margin-bottom: 20px;
}

/* Input Fields Styling */
.delivery-form input[type="text"],
.delivery-form textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    font-size: 14px;
}

.delivery-form input[type="text"]:focus,
.delivery-form textarea:focus {
    border-color: #4caf50;
    outline: none;
    box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
}

/* Button Styling */
.delivery-form button {
    width: 100%;
    padding: 10px;
    background-color: #8d6e63;
    color: #fff;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.delivery-form button:hover {
    background-color: #c3b39a;
}

/* Anchor Tag Styling */
.delivery-form a {
    text-decoration: none;
}

.delivery-form a button {
    display: block;
}

</style>